Output:  /zhome/77/9/213690/biometrics/black-hole/out/VIT-21k/both_eyes_together/Run_0-4
Epochs:  3
Learning rate:  5e-05
Dataset:  both_eyes_together
Batch size:  16
Labels of Dataset: ['female', 'male']
Loaded accuracy
ViTImageProcessor {
  "do_convert_rgb": null,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.5,
    0.5,
    0.5
  ],
  "image_processor_type": "ViTImageProcessor",
  "image_std": [
    0.5,
    0.5,
    0.5
  ],
  "resample": 2,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "height": 224,
    "width": 224
  }
}

ViTForImageClassification(
  (vit): ViTModel(
    (embeddings): ViTEmbeddings(
      (patch_embeddings): ViTPatchEmbeddings(
        (projection): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
      )
      (dropout): Dropout(p=0.0, inplace=False)
    )
    (encoder): ViTEncoder(
      (layer): ModuleList(
        (0-11): 12 x ViTLayer(
          (attention): ViTAttention(
            (attention): ViTSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
            )
            (output): ViTSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.0, inplace=False)
            )
          )
          (intermediate): ViTIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): ViTOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
          (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
          (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
      )
    )
    (layernorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
  )
  (classifier): Linear(in_features=768, out_features=2, bias=True)
)
{'loss': 0.684, 'grad_norm': 1.524399757385254, 'learning_rate': 4.797297297297298e-05, 'epoch': 0.14}
{'loss': 0.6079, 'grad_norm': 1.5538427829742432, 'learning_rate': 4.572072072072072e-05, 'epoch': 0.27}
{'loss': 0.6135, 'grad_norm': 4.332144737243652, 'learning_rate': 4.346846846846847e-05, 'epoch': 0.41}
{'loss': 0.5253, 'grad_norm': 3.7541110515594482, 'learning_rate': 4.1216216216216216e-05, 'epoch': 0.54}
{'loss': 0.4694, 'grad_norm': 5.493359088897705, 'learning_rate': 3.896396396396397e-05, 'epoch': 0.68}
{'eval_loss': 0.39593473076820374, 'eval_accuracy': 0.8412162162162162, 'eval_runtime': 3.9326, 'eval_samples_per_second': 75.268, 'eval_steps_per_second': 9.409, 'epoch': 0.68}
{'loss': 0.3633, 'grad_norm': 2.4944355487823486, 'learning_rate': 3.6711711711711715e-05, 'epoch': 0.81}
{'loss': 0.3294, 'grad_norm': 2.632366180419922, 'learning_rate': 3.445945945945946e-05, 'epoch': 0.95}
{'loss': 0.3776, 'grad_norm': 7.189682483673096, 'learning_rate': 3.220720720720721e-05, 'epoch': 1.08}
{'loss': 0.3026, 'grad_norm': 3.183009147644043, 'learning_rate': 2.9954954954954954e-05, 'epoch': 1.22}
{'loss': 0.2128, 'grad_norm': 3.302567958831787, 'learning_rate': 2.7702702702702704e-05, 'epoch': 1.35}
{'eval_loss': 0.3189718425273895, 'eval_accuracy': 0.8716216216216216, 'eval_runtime': 3.7013, 'eval_samples_per_second': 79.971, 'eval_steps_per_second': 9.996, 'epoch': 1.35}
{'loss': 0.1998, 'grad_norm': 1.2778832912445068, 'learning_rate': 2.5450450450450454e-05, 'epoch': 1.49}
{'loss': 0.1662, 'grad_norm': 4.4845685958862305, 'learning_rate': 2.3198198198198197e-05, 'epoch': 1.62}
{'loss': 0.2272, 'grad_norm': 1.6914833784103394, 'learning_rate': 2.0945945945945947e-05, 'epoch': 1.76}
{'loss': 0.2015, 'grad_norm': 3.6583428382873535, 'learning_rate': 1.8693693693693696e-05, 'epoch': 1.89}
{'loss': 0.202, 'grad_norm': 3.50512433052063, 'learning_rate': 1.6441441441441443e-05, 'epoch': 2.03}
{'eval_loss': 0.2989928722381592, 'eval_accuracy': 0.8817567567567568, 'eval_runtime': 3.7846, 'eval_samples_per_second': 78.212, 'eval_steps_per_second': 9.776, 'epoch': 2.03}
{'loss': 0.1005, 'grad_norm': 3.0349998474121094, 'learning_rate': 1.4189189189189189e-05, 'epoch': 2.16}
{'loss': 0.1137, 'grad_norm': 0.8333669900894165, 'learning_rate': 1.1936936936936937e-05, 'epoch': 2.3}
{'loss': 0.0826, 'grad_norm': 0.5722329616546631, 'learning_rate': 9.684684684684685e-06, 'epoch': 2.43}
{'loss': 0.0834, 'grad_norm': 5.295223236083984, 'learning_rate': 7.432432432432433e-06, 'epoch': 2.57}
{'loss': 0.0814, 'grad_norm': 4.310894966125488, 'learning_rate': 5.1801801801801805e-06, 'epoch': 2.7}
{'eval_loss': 0.21859736740589142, 'eval_accuracy': 0.9222972972972973, 'eval_runtime': 3.88, 'eval_samples_per_second': 76.288, 'eval_steps_per_second': 9.536, 'epoch': 2.7}
{'loss': 0.1013, 'grad_norm': 0.26947683095932007, 'learning_rate': 2.927927927927928e-06, 'epoch': 2.84}
{'loss': 0.1061, 'grad_norm': 0.4265654683113098, 'learning_rate': 6.756756756756758e-07, 'epoch': 2.97}
{'train_runtime': 94.0185, 'train_samples_per_second': 37.78, 'train_steps_per_second': 2.361, 'train_loss': 0.27746777098860825, 'epoch': 3.0}
***** train metrics *****
  epoch                    =         3.0
  total_flos               = 256347979GF
  train_loss               =      0.2775
  train_runtime            =  0:01:34.01
  train_samples_per_second =       37.78
  train_steps_per_second   =       2.361
Labels of Dataset: ['female', 'male']
Args run was set to True
Starting inference
Classification Metrics
Accuracy     : 0.922
Precision     : 0.958
Recall        : 0.863 (Sensitivity)
Specificity   : 0.970
F1 Score      : 0.908
AUC           : 0.978
EER:          : 0.078
