Output:  /zhome/77/9/213690/biometrics/black-hole/out/VIT-21k/both_eyes_together/Run_0-7c
Epochs:  5
Learning rate:  0.0002
Dataset:  both_eyes_together
Batch size:  32
Labels of Dataset: ['female', 'male']
Loaded accuracy
ViTImageProcessor {
  "do_convert_rgb": null,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.5,
    0.5,
    0.5
  ],
  "image_processor_type": "ViTImageProcessor",
  "image_std": [
    0.5,
    0.5,
    0.5
  ],
  "resample": 2,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "height": 224,
    "width": 224
  }
}

ViTForImageClassification(
  (vit): ViTModel(
    (embeddings): ViTEmbeddings(
      (patch_embeddings): ViTPatchEmbeddings(
        (projection): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
      )
      (dropout): Dropout(p=0.0, inplace=False)
    )
    (encoder): ViTEncoder(
      (layer): ModuleList(
        (0-11): 12 x ViTLayer(
          (attention): ViTAttention(
            (attention): ViTSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
            )
            (output): ViTSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.0, inplace=False)
            )
          )
          (intermediate): ViTIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): ViTOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
          (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
          (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
      )
    )
    (layernorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
  )
  (classifier): Linear(in_features=768, out_features=2, bias=True)
)
{'loss': 0.6685, 'grad_norm': 0.9098535180091858, 'learning_rate': 0.00019027027027027028, 'epoch': 0.27}
{'loss': 0.5717, 'grad_norm': 1.0411287546157837, 'learning_rate': 0.00017945945945945947, 'epoch': 0.54}
{'loss': 0.4618, 'grad_norm': 4.878896713256836, 'learning_rate': 0.00016864864864864866, 'epoch': 0.81}
{'loss': 0.3693, 'grad_norm': 1.9272875785827637, 'learning_rate': 0.00015783783783783785, 'epoch': 1.08}
{'loss': 0.2359, 'grad_norm': 1.762380599975586, 'learning_rate': 0.00014702702702702703, 'epoch': 1.35}
{'eval_loss': 0.3603275418281555, 'eval_accuracy': 0.8581081081081081, 'eval_runtime': 5.2244, 'eval_samples_per_second': 56.657, 'eval_steps_per_second': 7.082, 'epoch': 1.35}
{'loss': 0.2307, 'grad_norm': 1.7174253463745117, 'learning_rate': 0.00013621621621621622, 'epoch': 1.62}
{'loss': 0.3537, 'grad_norm': 1.696380853652954, 'learning_rate': 0.0001254054054054054, 'epoch': 1.89}
{'loss': 0.1863, 'grad_norm': 0.7706860899925232, 'learning_rate': 0.00011459459459459461, 'epoch': 2.16}
{'loss': 0.1665, 'grad_norm': 4.6602091789245605, 'learning_rate': 0.0001037837837837838, 'epoch': 2.43}
{'loss': 0.2549, 'grad_norm': 0.9023302793502808, 'learning_rate': 9.297297297297299e-05, 'epoch': 2.7}
{'eval_loss': 0.22553476691246033, 'eval_accuracy': 0.9222972972972973, 'eval_runtime': 3.7432, 'eval_samples_per_second': 79.078, 'eval_steps_per_second': 9.885, 'epoch': 2.7}
{'loss': 0.2002, 'grad_norm': 1.6412220001220703, 'learning_rate': 8.216216216216217e-05, 'epoch': 2.97}
{'loss': 0.0909, 'grad_norm': 1.3233238458633423, 'learning_rate': 7.135135135135136e-05, 'epoch': 3.24}
{'loss': 0.0736, 'grad_norm': 2.1925339698791504, 'learning_rate': 6.0540540540540543e-05, 'epoch': 3.51}
{'loss': 0.0706, 'grad_norm': 0.10320168733596802, 'learning_rate': 4.972972972972974e-05, 'epoch': 3.78}
{'loss': 0.0268, 'grad_norm': 0.09343569725751877, 'learning_rate': 3.8918918918918926e-05, 'epoch': 4.05}
{'eval_loss': 0.15481595695018768, 'eval_accuracy': 0.9527027027027027, 'eval_runtime': 3.7314, 'eval_samples_per_second': 79.327, 'eval_steps_per_second': 9.916, 'epoch': 4.05}
{'loss': 0.0129, 'grad_norm': 0.09785043448209763, 'learning_rate': 2.810810810810811e-05, 'epoch': 4.32}
{'loss': 0.0126, 'grad_norm': 0.9334638714790344, 'learning_rate': 1.72972972972973e-05, 'epoch': 4.59}
{'loss': 0.0122, 'grad_norm': 0.07332246005535126, 'learning_rate': 6.486486486486487e-06, 'epoch': 4.86}
{'train_runtime': 160.8009, 'train_samples_per_second': 36.816, 'train_steps_per_second': 1.15, 'train_loss': 0.2164119176767968, 'epoch': 5.0}
***** train metrics *****
  epoch                    =         5.0
  total_flos               = 427246632GF
  train_loss               =      0.2164
  train_runtime            =  0:02:40.80
  train_samples_per_second =      36.816
  train_steps_per_second   =        1.15
Labels of Dataset: ['female', 'male']
Args run was set to True
Starting inference
Classification Metrics
Accuracy     : 0.953
Precision     : 0.961
Recall        : 0.931 (Sensitivity)
Specificity   : 0.970
F1 Score      : 0.946
AUC           : 0.989
EER:          : 0.054
