Output:  /zhome/77/9/213690/biometrics/black-hole/out/VIT-21k/both_mirrored_eyes/Run_0-5
Epochs:  3
Learning rate:  5e-05
Dataset:  both_mirrored_eyes
Batch size:  8
Labels of Dataset: ['female', 'male']
Loaded accuracy
ViTImageProcessor {
  "do_convert_rgb": null,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.5,
    0.5,
    0.5
  ],
  "image_processor_type": "ViTImageProcessor",
  "image_std": [
    0.5,
    0.5,
    0.5
  ],
  "resample": 2,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "height": 224,
    "width": 224
  }
}

ViTForImageClassification(
  (vit): ViTModel(
    (embeddings): ViTEmbeddings(
      (patch_embeddings): ViTPatchEmbeddings(
        (projection): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
      )
      (dropout): Dropout(p=0.0, inplace=False)
    )
    (encoder): ViTEncoder(
      (layer): ModuleList(
        (0-11): 12 x ViTLayer(
          (attention): ViTAttention(
            (attention): ViTSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
            )
            (output): ViTSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.0, inplace=False)
            )
          )
          (intermediate): ViTIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): ViTOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
          (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
          (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
      )
    )
    (layernorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
  )
  (classifier): Linear(in_features=768, out_features=2, bias=True)
)
{'loss': 0.6932, 'grad_norm': 3.4195261001586914, 'learning_rate': 4.9500000000000004e-05, 'epoch': 0.03}
{'loss': 0.6953, 'grad_norm': 1.0020464658737183, 'learning_rate': 4.894444444444445e-05, 'epoch': 0.07}
{'loss': 0.6865, 'grad_norm': 2.561609983444214, 'learning_rate': 4.838888888888889e-05, 'epoch': 0.1}
{'loss': 0.6367, 'grad_norm': 2.0344247817993164, 'learning_rate': 4.7833333333333335e-05, 'epoch': 0.13}
{'loss': 0.6519, 'grad_norm': 1.8942196369171143, 'learning_rate': 4.727777777777778e-05, 'epoch': 0.17}
{'eval_loss': 0.6362459659576416, 'eval_accuracy': 0.6216666666666667, 'eval_runtime': 8.0122, 'eval_samples_per_second': 74.886, 'eval_steps_per_second': 9.361, 'epoch': 0.17}
{'loss': 0.6123, 'grad_norm': 2.8021047115325928, 'learning_rate': 4.672222222222222e-05, 'epoch': 0.2}
{'loss': 0.6465, 'grad_norm': 1.5388067960739136, 'learning_rate': 4.6166666666666666e-05, 'epoch': 0.23}
{'loss': 0.6112, 'grad_norm': 4.735309600830078, 'learning_rate': 4.561111111111112e-05, 'epoch': 0.27}
{'loss': 0.507, 'grad_norm': 3.9959163665771484, 'learning_rate': 4.5055555555555554e-05, 'epoch': 0.3}
{'loss': 0.4853, 'grad_norm': 2.5862772464752197, 'learning_rate': 4.4500000000000004e-05, 'epoch': 0.33}
{'eval_loss': 0.4237813949584961, 'eval_accuracy': 0.8116666666666666, 'eval_runtime': 7.5104, 'eval_samples_per_second': 79.889, 'eval_steps_per_second': 9.986, 'epoch': 0.33}
{'loss': 0.4463, 'grad_norm': 7.0122270584106445, 'learning_rate': 4.394444444444445e-05, 'epoch': 0.37}
{'loss': 0.5313, 'grad_norm': 5.0518412590026855, 'learning_rate': 4.338888888888889e-05, 'epoch': 0.4}
{'loss': 0.3528, 'grad_norm': 3.5856027603149414, 'learning_rate': 4.2833333333333335e-05, 'epoch': 0.43}
{'loss': 0.6411, 'grad_norm': 3.3542463779449463, 'learning_rate': 4.227777777777778e-05, 'epoch': 0.47}
{'loss': 0.3589, 'grad_norm': 0.9642289280891418, 'learning_rate': 4.172222222222222e-05, 'epoch': 0.5}
{'eval_loss': 0.344901442527771, 'eval_accuracy': 0.85, 'eval_runtime': 7.4775, 'eval_samples_per_second': 80.24, 'eval_steps_per_second': 10.03, 'epoch': 0.5}
{'loss': 0.4832, 'grad_norm': 11.119485855102539, 'learning_rate': 4.116666666666667e-05, 'epoch': 0.53}
{'loss': 0.3923, 'grad_norm': 8.03208065032959, 'learning_rate': 4.061111111111111e-05, 'epoch': 0.57}
{'loss': 0.3686, 'grad_norm': 3.6179659366607666, 'learning_rate': 4.0055555555555554e-05, 'epoch': 0.6}
{'loss': 0.3398, 'grad_norm': 2.6978561878204346, 'learning_rate': 3.9500000000000005e-05, 'epoch': 0.63}
{'loss': 0.3991, 'grad_norm': 1.66520094871521, 'learning_rate': 3.894444444444444e-05, 'epoch': 0.67}
{'eval_loss': 0.3875986933708191, 'eval_accuracy': 0.85, 'eval_runtime': 7.3822, 'eval_samples_per_second': 81.276, 'eval_steps_per_second': 10.16, 'epoch': 0.67}
{'loss': 0.517, 'grad_norm': 4.6591033935546875, 'learning_rate': 3.838888888888889e-05, 'epoch': 0.7}
{'loss': 0.4184, 'grad_norm': 1.3195933103561401, 'learning_rate': 3.7833333333333336e-05, 'epoch': 0.73}
{'loss': 0.2297, 'grad_norm': 6.420109272003174, 'learning_rate': 3.727777777777778e-05, 'epoch': 0.77}
{'loss': 0.4201, 'grad_norm': 14.515069961547852, 'learning_rate': 3.672222222222222e-05, 'epoch': 0.8}
{'loss': 0.3128, 'grad_norm': 6.944654941558838, 'learning_rate': 3.6166666666666674e-05, 'epoch': 0.83}
{'eval_loss': 0.36852526664733887, 'eval_accuracy': 0.865, 'eval_runtime': 7.3864, 'eval_samples_per_second': 81.23, 'eval_steps_per_second': 10.154, 'epoch': 0.83}
{'loss': 0.6978, 'grad_norm': 6.967179775238037, 'learning_rate': 3.561111111111111e-05, 'epoch': 0.87}
{'loss': 0.3636, 'grad_norm': 5.147952079772949, 'learning_rate': 3.505555555555556e-05, 'epoch': 0.9}
{'loss': 0.3082, 'grad_norm': 6.609080791473389, 'learning_rate': 3.45e-05, 'epoch': 0.93}
{'loss': 0.3496, 'grad_norm': 15.02712345123291, 'learning_rate': 3.394444444444444e-05, 'epoch': 0.97}
{'loss': 0.363, 'grad_norm': 3.366093397140503, 'learning_rate': 3.338888888888889e-05, 'epoch': 1.0}
{'eval_loss': 0.29043474793434143, 'eval_accuracy': 0.8866666666666667, 'eval_runtime': 7.3941, 'eval_samples_per_second': 81.145, 'eval_steps_per_second': 10.143, 'epoch': 1.0}
{'loss': 0.1858, 'grad_norm': 4.56528377532959, 'learning_rate': 3.283333333333333e-05, 'epoch': 1.03}
{'loss': 0.2312, 'grad_norm': 5.2091779708862305, 'learning_rate': 3.227777777777778e-05, 'epoch': 1.07}
{'loss': 0.2387, 'grad_norm': 1.159837245941162, 'learning_rate': 3.1722222222222224e-05, 'epoch': 1.1}
{'loss': 0.1821, 'grad_norm': 4.102014541625977, 'learning_rate': 3.116666666666667e-05, 'epoch': 1.13}
{'loss': 0.3151, 'grad_norm': 9.146880149841309, 'learning_rate': 3.061111111111111e-05, 'epoch': 1.17}
{'eval_loss': 0.3183412551879883, 'eval_accuracy': 0.8866666666666667, 'eval_runtime': 7.4977, 'eval_samples_per_second': 80.025, 'eval_steps_per_second': 10.003, 'epoch': 1.17}
{'loss': 0.2683, 'grad_norm': 0.35828760266304016, 'learning_rate': 3.005555555555556e-05, 'epoch': 1.2}
{'loss': 0.3406, 'grad_norm': 3.985034227371216, 'learning_rate': 2.95e-05, 'epoch': 1.23}
{'loss': 0.1379, 'grad_norm': 4.318536281585693, 'learning_rate': 2.8944444444444446e-05, 'epoch': 1.27}
{'loss': 0.2601, 'grad_norm': 5.862288475036621, 'learning_rate': 2.8388888888888893e-05, 'epoch': 1.3}
{'loss': 0.1859, 'grad_norm': 0.5460004806518555, 'learning_rate': 2.7833333333333333e-05, 'epoch': 1.33}
{'eval_loss': 0.38726159930229187, 'eval_accuracy': 0.8566666666666667, 'eval_runtime': 7.4011, 'eval_samples_per_second': 81.069, 'eval_steps_per_second': 10.134, 'epoch': 1.33}
{'loss': 0.2345, 'grad_norm': 8.769282341003418, 'learning_rate': 2.727777777777778e-05, 'epoch': 1.37}
{'loss': 0.144, 'grad_norm': 0.5665740370750427, 'learning_rate': 2.6722222222222228e-05, 'epoch': 1.4}
{'loss': 0.3384, 'grad_norm': 24.571788787841797, 'learning_rate': 2.6166666666666668e-05, 'epoch': 1.43}
{'loss': 0.3215, 'grad_norm': 2.7063381671905518, 'learning_rate': 2.5611111111111115e-05, 'epoch': 1.47}
{'loss': 0.1591, 'grad_norm': 1.1232093572616577, 'learning_rate': 2.5055555555555555e-05, 'epoch': 1.5}
{'eval_loss': 0.2933307886123657, 'eval_accuracy': 0.8983333333333333, 'eval_runtime': 7.3836, 'eval_samples_per_second': 81.261, 'eval_steps_per_second': 10.158, 'epoch': 1.5}
{'loss': 0.2582, 'grad_norm': 0.3358141779899597, 'learning_rate': 2.45e-05, 'epoch': 1.53}
{'loss': 0.0674, 'grad_norm': 16.940183639526367, 'learning_rate': 2.3944444444444443e-05, 'epoch': 1.57}
{'loss': 0.281, 'grad_norm': 10.728363990783691, 'learning_rate': 2.338888888888889e-05, 'epoch': 1.6}
{'loss': 0.2316, 'grad_norm': 2.0766232013702393, 'learning_rate': 2.2833333333333334e-05, 'epoch': 1.63}
{'loss': 0.1801, 'grad_norm': 0.7982891201972961, 'learning_rate': 2.2277777777777778e-05, 'epoch': 1.67}
{'eval_loss': 0.29315611720085144, 'eval_accuracy': 0.895, 'eval_runtime': 7.4743, 'eval_samples_per_second': 80.275, 'eval_steps_per_second': 10.034, 'epoch': 1.67}
{'loss': 0.072, 'grad_norm': 0.16562165319919586, 'learning_rate': 2.1722222222222225e-05, 'epoch': 1.7}
{'loss': 0.0874, 'grad_norm': 5.981027126312256, 'learning_rate': 2.116666666666667e-05, 'epoch': 1.73}
{'loss': 0.067, 'grad_norm': 0.1719380021095276, 'learning_rate': 2.0611111111111112e-05, 'epoch': 1.77}
{'loss': 0.3984, 'grad_norm': 2.7702507972717285, 'learning_rate': 2.0055555555555556e-05, 'epoch': 1.8}
{'loss': 0.0766, 'grad_norm': 0.12962685525417328, 'learning_rate': 1.9500000000000003e-05, 'epoch': 1.83}
{'eval_loss': 0.2942551374435425, 'eval_accuracy': 0.9033333333333333, 'eval_runtime': 7.4359, 'eval_samples_per_second': 80.69, 'eval_steps_per_second': 10.086, 'epoch': 1.83}
{'loss': 0.2856, 'grad_norm': 4.157415390014648, 'learning_rate': 1.8944444444444447e-05, 'epoch': 1.87}
{'loss': 0.1642, 'grad_norm': 11.80706787109375, 'learning_rate': 1.838888888888889e-05, 'epoch': 1.9}
{'loss': 0.222, 'grad_norm': 0.33253899216651917, 'learning_rate': 1.7833333333333334e-05, 'epoch': 1.93}
{'loss': 0.3723, 'grad_norm': 0.6041679382324219, 'learning_rate': 1.7277777777777778e-05, 'epoch': 1.97}
{'loss': 0.1505, 'grad_norm': 17.322063446044922, 'learning_rate': 1.6722222222222222e-05, 'epoch': 2.0}
{'eval_loss': 0.2359972447156906, 'eval_accuracy': 0.9216666666666666, 'eval_runtime': 7.4196, 'eval_samples_per_second': 80.867, 'eval_steps_per_second': 10.108, 'epoch': 2.0}
{'loss': 0.1243, 'grad_norm': 0.5321649312973022, 'learning_rate': 1.6166666666666665e-05, 'epoch': 2.03}
{'loss': 0.0971, 'grad_norm': 0.8681055307388306, 'learning_rate': 1.5611111111111113e-05, 'epoch': 2.07}
{'loss': 0.198, 'grad_norm': 4.373414993286133, 'learning_rate': 1.5055555555555556e-05, 'epoch': 2.1}
{'loss': 0.1014, 'grad_norm': 0.11936154961585999, 'learning_rate': 1.45e-05, 'epoch': 2.13}
{'loss': 0.0647, 'grad_norm': 0.2622166574001312, 'learning_rate': 1.3944444444444446e-05, 'epoch': 2.17}
{'eval_loss': 0.2819630801677704, 'eval_accuracy': 0.9083333333333333, 'eval_runtime': 7.4989, 'eval_samples_per_second': 80.011, 'eval_steps_per_second': 10.001, 'epoch': 2.17}
{'loss': 0.0537, 'grad_norm': 0.09437564015388489, 'learning_rate': 1.338888888888889e-05, 'epoch': 2.2}
{'loss': 0.063, 'grad_norm': 0.12788240611553192, 'learning_rate': 1.2833333333333333e-05, 'epoch': 2.23}
{'loss': 0.0422, 'grad_norm': 0.1399099975824356, 'learning_rate': 1.2277777777777778e-05, 'epoch': 2.27}
{'loss': 0.0446, 'grad_norm': 0.23470734059810638, 'learning_rate': 1.1722222222222224e-05, 'epoch': 2.3}
{'loss': 0.0422, 'grad_norm': 0.1118931844830513, 'learning_rate': 1.1166666666666668e-05, 'epoch': 2.33}
{'eval_loss': 0.31536465883255005, 'eval_accuracy': 0.905, 'eval_runtime': 7.3771, 'eval_samples_per_second': 81.332, 'eval_steps_per_second': 10.167, 'epoch': 2.33}
{'loss': 0.1948, 'grad_norm': 0.15029239654541016, 'learning_rate': 1.0611111111111111e-05, 'epoch': 2.37}
{'loss': 0.026, 'grad_norm': 1.9493625164031982, 'learning_rate': 1.0055555555555555e-05, 'epoch': 2.4}
{'loss': 0.0158, 'grad_norm': 6.315882205963135, 'learning_rate': 9.5e-06, 'epoch': 2.43}
{'loss': 0.0411, 'grad_norm': 0.14750848710536957, 'learning_rate': 8.944444444444444e-06, 'epoch': 2.47}
{'loss': 0.0124, 'grad_norm': 0.17076179385185242, 'learning_rate': 8.38888888888889e-06, 'epoch': 2.5}
{'eval_loss': 0.28310760855674744, 'eval_accuracy': 0.9133333333333333, 'eval_runtime': 7.3955, 'eval_samples_per_second': 81.131, 'eval_steps_per_second': 10.141, 'epoch': 2.5}
{'loss': 0.1069, 'grad_norm': 13.963057518005371, 'learning_rate': 7.833333333333333e-06, 'epoch': 2.53}
{'loss': 0.097, 'grad_norm': 0.31462278962135315, 'learning_rate': 7.277777777777778e-06, 'epoch': 2.57}
{'loss': 0.0536, 'grad_norm': 0.08612322807312012, 'learning_rate': 6.722222222222223e-06, 'epoch': 2.6}
{'loss': 0.0129, 'grad_norm': 0.12875288724899292, 'learning_rate': 6.166666666666667e-06, 'epoch': 2.63}
{'loss': 0.0491, 'grad_norm': 0.09857548028230667, 'learning_rate': 5.611111111111112e-06, 'epoch': 2.67}
{'eval_loss': 0.259794145822525, 'eval_accuracy': 0.9333333333333333, 'eval_runtime': 7.4784, 'eval_samples_per_second': 80.231, 'eval_steps_per_second': 10.029, 'epoch': 2.67}
{'loss': 0.1175, 'grad_norm': 0.11326783150434494, 'learning_rate': 5.0555555555555555e-06, 'epoch': 2.7}
{'loss': 0.1042, 'grad_norm': 0.09013247489929199, 'learning_rate': 4.5e-06, 'epoch': 2.73}
{'loss': 0.067, 'grad_norm': 0.12212908267974854, 'learning_rate': 3.944444444444445e-06, 'epoch': 2.77}
{'loss': 0.119, 'grad_norm': 0.9615222811698914, 'learning_rate': 3.3888888888888893e-06, 'epoch': 2.8}
{'loss': 0.0667, 'grad_norm': 0.2443271428346634, 'learning_rate': 2.8333333333333335e-06, 'epoch': 2.83}
{'eval_loss': 0.34004929661750793, 'eval_accuracy': 0.8983333333333333, 'eval_runtime': 7.39, 'eval_samples_per_second': 81.191, 'eval_steps_per_second': 10.149, 'epoch': 2.83}
{'loss': 0.0117, 'grad_norm': 0.10292201489210129, 'learning_rate': 2.277777777777778e-06, 'epoch': 2.87}
{'loss': 0.0187, 'grad_norm': 1.519580364227295, 'learning_rate': 1.7222222222222222e-06, 'epoch': 2.9}
{'loss': 0.2356, 'grad_norm': 3.6607425212860107, 'learning_rate': 1.1666666666666668e-06, 'epoch': 2.93}
{'loss': 0.0323, 'grad_norm': 0.6814067959785461, 'learning_rate': 6.111111111111112e-07, 'epoch': 2.97}
{'loss': 0.0128, 'grad_norm': 0.22393029928207397, 'learning_rate': 5.555555555555556e-08, 'epoch': 3.0}
{'eval_loss': 0.27566763758659363, 'eval_accuracy': 0.9233333333333333, 'eval_runtime': 7.3823, 'eval_samples_per_second': 81.275, 'eval_steps_per_second': 10.159, 'epoch': 3.0}
{'train_runtime': 312.9431, 'train_samples_per_second': 23.007, 'train_steps_per_second': 2.876, 'train_loss': 0.25781946967045466, 'epoch': 3.0}
***** train metrics *****
  epoch                    =         3.0
  total_flos               = 519624282GF
  train_loss               =      0.2578
  train_runtime            =  0:05:12.94
  train_samples_per_second =      23.007
  train_steps_per_second   =       2.876
Labels of Dataset: ['female', 'male']
Classification Metrics
Accuracy     : 0.923
Precision     : 0.939
Recall        : 0.908 (Sensitivity)
Specificity   : 0.939
F1 Score      : 0.923
AUC           : 0.977
EER:          : 0.075
